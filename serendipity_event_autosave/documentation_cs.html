<html>
    <head>
        <title>Dokumentace: Autosave</title>
    </head>

<body>
    
<h1>Dokumentace k pluginu 'Autosave'</h1>

<p>Dokumentaci k tomuto pluginu pøeloil do èeštiny Vladimír Ajgl (vlada [zavinac] ajgl [tecka] cz) dne 29.12.2009. Od té doby mohl bıt plugin pozmìnìn nebo mohly bıt rozšíøené jeho funkce. Zkontrolujte pro jistotu i <a href="documentation_en.html">aktuální anglickou dokumentaci</a>.
<p>

<h1>Jak zaèít - nastavení</h1>
<p><ol>
Jakmile nainstalujete plugin, mìli byste nastavit dvì volby:
<li><strong>Interval ukládání</strong> - Zadáte poèet sekund mezi dvìmi voláními funkce automatického uloení. Nebo zadáte 0 a pak bude automatické ukládání vypnuto. I pøi vypnutém automatickém ukládání je ale stále moné uloit pøíspìvek ruènì kliknutím na tlaèítko "Uloit".</li>
<li><strong>Relativní http adresa</strong> - relativnì k umístìní blogu. Vıchozí hodnota by mìla dobøe fungovat pro vìtšinu uivatelù.</li>
</ol>
Pak mùete zaèít sepisovat pøíspìvky.
</p>

<h1>Chování u ji publikovanıch pøíspìvkù</h1>
<p>
Zabralo poøádnou chvíli vymyslet, jak má plugin pracovat u ji vydanıch pøíspìvkù. Nakonec pracuje takto:<br />
Nešlo jednoduše pøepsat existující pøíspìvek, protoe by návštìvníci blogu vidìli èásteèné zmìny ještì pøed dokonèením pøíspìvku. Take se pouívá "stínová kopie", jinı, doèasnı pøíspìvek uloenı jako koncept, jeho název zaèíná '[AUTOSAVED] '. Pùvodní pøíspìvek je svázán se svou stínovou kopií pomocí jedné vlastnosti.
</p>

<h1>Obnova po pádu prohlíeèe</h1>
<p>
Pokud pøíspìvek ještì nebyl publikován, jednoduše upravte koncept, odstraòte z nadpisu text '[AUTOSAVED] ', dokonèete text a ulote pøíspìvek:-)
</p>
<p>
Pokud u jste pøíspìvek publikovali, vrate se k jeho editaci (nestarejte se o svázanou stínovou kopii). Mìli byste mít k dispozici druhı odkaz. Poté, co na nìj kliknete, bude nataena verze s automaticky uloenımi daty. Dokonèete pøíspìvek a ulote ho jako obvykle. Pøíspìvek bude uloen a stínová kopie bude smazána.
</p>
<p>
Poznámka: V souèasné dobì se mi nadaøí obnovení staré verze "inline" (pomocí ajaxu), kvùli WYSIWYG editorùm ;-(
</p>

<h1>Jak to funguje uvnitø?!?</h1>
<p>
Všechna ta kouzla jsou dìlána pomocí AJAXového volání v javascriptu. K tomu je pouita knihovna Rico. Kdy je stránka s editací pøíspìvku nataena, je inicializován ajaxovı engine. Vánì nic ohromujícího. Je pøiøazena kadá koncová url adresa s logickım jménem pro zjednodušení pozdìjších volání a také je registrován html element (span), kterı obdrí vısledky volání.
</p>
<p>
Jakmile uplyne nastavená doba (a nebo pøi explicitním ruèním klinutí), je vytvoøeno a odesláno ajaxové volání, které obsahuje text editovaného pøíspìvku, s vıjimkou statustu publikace, kterı je automaticky nastaven na "koncept", aby se zabránilo zveøejnìní nedopsanıch pøíspìvkù. Na stranì serveru jsou data uloena pomocí stejného kódu, jako pøi standardním uloení pøíspìvku (napø. include/admin/entries.php je "vloen" s adminAction nastavenou na 'save'). Pokud je potøeba (napø. pro ještì neuloenı pøíspìvek), novì vkládané skryté pole "entryid" je aktualizováno novì vygenerovanım ID èíslem, take po stisknutí tlaèítka "Uloit" bude pøíspìvek uloen s dokonèenım textem :-)
</p>

<h1>Poadavky</h1>
<p>
<ol>
<li>Ajax-kompatibilní prohlíeè, tedy prohlíeè, kterı poskytuje objekt XmlHttpRequest. Plugin byl úspìšnì otestován v prohlíeèích Firefox 1.5 a IE 6.0 SP2 (viz. domovská stránka knihovny RICO, èást podporované prohlíeèe), vèetnì WYSIWYG editorù TinyMCE a vıchozím editorem HtmlArea.</li>
<li>Plugin aktuálnì nefunguje s WYSIWYG editorem Xhina (pracuje se na tom, by pracoval) a nebyl otestován v kombinvaci s pluginem 'versioning' (rùzné verze jednoho pøíspìvku). Dobrovolníci na testování? :-)</li>
<li>Funguje perfektnì s pluginem entrycheck.</li>
</ol>
</p>

<h1>Závìr</h1>
<p>
Neostıchejte se poslat mi jakékoliv komentáøe, otázky, námìty, pøeklady (jay [teèka] bertrand [zavináè] free [teèka] fr).
</p>
</body>
