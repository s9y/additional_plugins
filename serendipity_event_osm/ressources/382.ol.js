"use strict";(self.webpackChunkol=self.webpackChunkol||[]).push([[382],{165:function(t,e,n){function r(t,e){let n=t.length-e,r=0;do{for(let n=e;n>0;n--)t[r+e]+=t[r],r++;n-=e}while(n>0)}function o(t,e,n){let r=0,o=t.length;const s=o/n;for(;o>e;){for(let n=e;n>0;--n)t[r+e]+=t[r],++r;o-=e}const c=t.slice();for(let e=0;e<s;++e)for(let r=0;r<n;++r)t[n*e+r]=c[(n-r-1)*s+e]}n.d(e,{Z:function(){return s}});class s{async decode(t,e){const n=await this.decodeBlock(e),s=t.Predictor||1;if(1!==s){const e=!t.StripOffsets;return function(t,e,n,s,c,i){if(!e||1===e)return t;for(let t=0;t<c.length;++t){if(c[t]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(c[t]!==c[0])throw new Error("When decoding with predictor, all samples must have the same size.")}const f=c[0]/8,a=2===i?1:c.length;for(let i=0;i<s&&!(i*a*n*f>=t.byteLength);++i){let s;if(2===e){switch(c[0]){case 8:s=new Uint8Array(t,i*a*n*f,a*n*f);break;case 16:s=new Uint16Array(t,i*a*n*f,a*n*f/2);break;case 32:s=new Uint32Array(t,i*a*n*f,a*n*f/4);break;default:throw new Error(`Predictor 2 not allowed with ${c[0]} bits per sample.`)}r(s,a)}else 3===e&&(s=new Uint8Array(t,i*a*n*f,a*n*f),o(s,a,f))}return t}(n,s,e?t.TileWidth:t.ImageWidth,e?t.TileLength:t.RowsPerStrip||t.ImageLength,t.BitsPerSample,t.PlanarConfiguration)}return n}}},382:function(t,e,n){n.r(e),n.d(e,{default:function(){return k}});var r=n(165);const o=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),s=4017,c=799,i=3406,f=2276,a=1567,l=3784,u=5793,h=2896;function w(t,e){let n=0;const r=[];let o=16;for(;o>0&&!t[o-1];)--o;r.push({children:[],index:0});let s,c=r[0];for(let i=0;i<o;i++){for(let o=0;o<t[i];o++){for(c=r.pop(),c.children[c.index]=e[n];c.index>0;)c=r.pop();for(c.index++,r.push(c);r.length<=i;)r.push(s={children:[],index:0}),c.children[c.index]=s.children,c=s;n++}i+1<o&&(r.push(s={children:[],index:0}),c.children[c.index]=s.children,c=s)}return r[0].children}function d(t,e,n,r,s,c,i,f,a){const{mcusPerLine:l,progressive:u}=n,h=e;let w=e,d=0,b=0;function m(){if(b>0)return b--,d>>b&1;if(d=t[w++],255===d){const e=t[w++];if(e)throw new Error(`unexpected marker: ${(d<<8|e).toString(16)}`)}return b=7,d>>>7}function k(t){let e,n=t;for(;null!==(e=m());){if(n=n[e],"number"==typeof n)return n;if("object"!=typeof n)throw new Error("invalid huffman sequence")}return null}function p(t){let e=t,n=0;for(;e>0;){const t=m();if(null===t)return;n=n<<1|t,--e}return n}function y(t){const e=p(t);return e>=1<<t-1?e:e+(-1<<t)+1}let A=0;let v,E=0;function U(t,e,n,r,o){const s=n%l,c=(n/l|0)*t.v+r,i=s*t.h+o;e(t,t.blocks[c][i])}function g(t,e,n){const r=n/t.blocksPerLine|0,o=n%t.blocksPerLine;e(t,t.blocks[r][o])}const x=r.length;let I,M,P,D,L,O;O=u?0===c?0===f?function(t,e){const n=k(t.huffmanTableDC),r=0===n?0:y(n)<<a;t.pred+=r,e[0]=t.pred}:function(t,e){e[0]|=m()<<a}:0===f?function(t,e){if(A>0)return void A--;let n=c;const r=i;for(;n<=r;){const r=k(t.huffmanTableAC),s=15&r,c=r>>4;if(0===s){if(c<15){A=p(c)+(1<<c)-1;break}n+=16}else n+=c,e[o[n]]=y(s)*(1<<a),n++}}:function(t,e){let n=c;const r=i;let s=0;for(;n<=r;){const r=o[n],c=e[r]<0?-1:1;switch(E){case 0:{const e=k(t.huffmanTableAC),n=15&e;if(s=e>>4,0===n)s<15?(A=p(s)+(1<<s),E=4):(s=16,E=1);else{if(1!==n)throw new Error("invalid ACn encoding");v=y(n),E=s?2:3}continue}case 1:case 2:e[r]?e[r]+=(m()<<a)*c:(s--,0===s&&(E=2===E?3:0));break;case 3:e[r]?e[r]+=(m()<<a)*c:(e[r]=v<<a,E=0);break;case 4:e[r]&&(e[r]+=(m()<<a)*c)}n++}4===E&&(A--,0===A&&(E=0))}:function(t,e){const n=k(t.huffmanTableDC),r=0===n?0:y(n);t.pred+=r,e[0]=t.pred;let s=1;for(;s<64;){const n=k(t.huffmanTableAC),r=15&n,c=n>>4;if(0===r){if(c<15)break;s+=16}else s+=c,e[o[s]]=y(r),s++}};let j,C,W=0;C=1===x?r[0].blocksPerLine*r[0].blocksPerColumn:l*n.mcusPerColumn;const $=s||C;for(;W<C;){for(M=0;M<x;M++)r[M].pred=0;if(A=0,1===x)for(I=r[0],L=0;L<$;L++)g(I,O,W),W++;else for(L=0;L<$;L++){for(M=0;M<x;M++){I=r[M];const{h:t,v:e}=I;for(P=0;P<e;P++)for(D=0;D<t;D++)U(I,O,W,P,D)}if(W++,W===C)break}if(b=0,j=t[w]<<8|t[w+1],j<65280)throw new Error("marker was not found");if(!(j>=65488&&j<=65495))break;w+=2}return w-h}function b(t,e){const n=[],{blocksPerLine:r,blocksPerColumn:o}=e,w=r<<3,d=new Int32Array(64),b=new Uint8Array(64);function m(t,n,r){const o=e.quantizationTable;let w,d,b,m,k,p,y,A,v;const E=r;let U;for(U=0;U<64;U++)E[U]=t[U]*o[U];for(U=0;U<8;++U){const t=8*U;0!==E[1+t]||0!==E[2+t]||0!==E[3+t]||0!==E[4+t]||0!==E[5+t]||0!==E[6+t]||0!==E[7+t]?(w=u*E[0+t]+128>>8,d=u*E[4+t]+128>>8,b=E[2+t],m=E[6+t],k=h*(E[1+t]-E[7+t])+128>>8,A=h*(E[1+t]+E[7+t])+128>>8,p=E[3+t]<<4,y=E[5+t]<<4,v=w-d+1>>1,w=w+d+1>>1,d=v,v=b*l+m*a+128>>8,b=b*a-m*l+128>>8,m=v,v=k-y+1>>1,k=k+y+1>>1,y=v,v=A+p+1>>1,p=A-p+1>>1,A=v,v=w-m+1>>1,w=w+m+1>>1,m=v,v=d-b+1>>1,d=d+b+1>>1,b=v,v=k*f+A*i+2048>>12,k=k*i-A*f+2048>>12,A=v,v=p*c+y*s+2048>>12,p=p*s-y*c+2048>>12,y=v,E[0+t]=w+A,E[7+t]=w-A,E[1+t]=d+y,E[6+t]=d-y,E[2+t]=b+p,E[5+t]=b-p,E[3+t]=m+k,E[4+t]=m-k):(v=u*E[0+t]+512>>10,E[0+t]=v,E[1+t]=v,E[2+t]=v,E[3+t]=v,E[4+t]=v,E[5+t]=v,E[6+t]=v,E[7+t]=v)}for(U=0;U<8;++U){const t=U;0!==E[8+t]||0!==E[16+t]||0!==E[24+t]||0!==E[32+t]||0!==E[40+t]||0!==E[48+t]||0!==E[56+t]?(w=u*E[0+t]+2048>>12,d=u*E[32+t]+2048>>12,b=E[16+t],m=E[48+t],k=h*(E[8+t]-E[56+t])+2048>>12,A=h*(E[8+t]+E[56+t])+2048>>12,p=E[24+t],y=E[40+t],v=w-d+1>>1,w=w+d+1>>1,d=v,v=b*l+m*a+2048>>12,b=b*a-m*l+2048>>12,m=v,v=k-y+1>>1,k=k+y+1>>1,y=v,v=A+p+1>>1,p=A-p+1>>1,A=v,v=w-m+1>>1,w=w+m+1>>1,m=v,v=d-b+1>>1,d=d+b+1>>1,b=v,v=k*f+A*i+2048>>12,k=k*i-A*f+2048>>12,A=v,v=p*c+y*s+2048>>12,p=p*s-y*c+2048>>12,y=v,E[0+t]=w+A,E[56+t]=w-A,E[8+t]=d+y,E[48+t]=d-y,E[16+t]=b+p,E[40+t]=b-p,E[24+t]=m+k,E[32+t]=m-k):(v=u*r[U+0]+8192>>14,E[0+t]=v,E[8+t]=v,E[16+t]=v,E[24+t]=v,E[32+t]=v,E[40+t]=v,E[48+t]=v,E[56+t]=v)}for(U=0;U<64;++U){const t=128+(E[U]+8>>4);n[U]=t<0?0:t>255?255:t}}for(let t=0;t<o;t++){const o=t<<3;for(let t=0;t<8;t++)n.push(new Uint8Array(w));for(let s=0;s<r;s++){m(e.blocks[t][s],b,d);let r=0;const c=s<<3;for(let t=0;t<8;t++){const e=n[o+t];for(let t=0;t<8;t++)e[c+t]=b[r++]}}}return n}class m{constructor(){this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}resetFrames(){this.frames=[]}parse(t){let e=0;function n(){const n=t[e]<<8|t[e+1];return e+=2,n}function r(){const r=n(),o=t.subarray(e,e+r-2);return e+=o.length,o}function s(t){let e,n,r=0,o=0;for(n in t.components)t.components.hasOwnProperty(n)&&(e=t.components[n],r<e.h&&(r=e.h),o<e.v&&(o=e.v));const s=Math.ceil(t.samplesPerLine/8/r),c=Math.ceil(t.scanLines/8/o);for(n in t.components)if(t.components.hasOwnProperty(n)){e=t.components[n];const i=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/r),f=Math.ceil(Math.ceil(t.scanLines/8)*e.v/o),a=s*e.h,l=c*e.v,u=[];for(let t=0;t<l;t++){const t=[];for(let e=0;e<a;e++)t.push(new Int32Array(64));u.push(t)}e.blocksPerLine=i,e.blocksPerColumn=f,e.blocks=u}t.maxH=r,t.maxV=o,t.mcusPerLine=s,t.mcusPerColumn=c}let c=n();if(65496!==c)throw new Error("SOI not found");for(c=n();65497!==c;){switch(c){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:{const t=r();65504===c&&74===t[0]&&70===t[1]&&73===t[2]&&70===t[3]&&0===t[4]&&(this.jfif={version:{major:t[5],minor:t[6]},densityUnits:t[7],xDensity:t[8]<<8|t[9],yDensity:t[10]<<8|t[11],thumbWidth:t[12],thumbHeight:t[13],thumbData:t.subarray(14,14+3*t[12]*t[13])}),65518===c&&65===t[0]&&100===t[1]&&111===t[2]&&98===t[3]&&101===t[4]&&0===t[5]&&(this.adobe={version:t[6],flags0:t[7]<<8|t[8],flags1:t[9]<<8|t[10],transformCode:t[11]});break}case 65499:{const r=n()+e-2;for(;e<r;){const r=t[e++],s=new Int32Array(64);if(r>>4==0)for(let n=0;n<64;n++){s[o[n]]=t[e++]}else{if(r>>4!=1)throw new Error("DQT: invalid table spec");for(let t=0;t<64;t++){s[o[t]]=n()}}this.quantizationTables[15&r]=s}break}case 65472:case 65473:case 65474:{n();const r={extended:65473===c,progressive:65474===c,precision:t[e++],scanLines:n(),samplesPerLine:n(),components:{},componentsOrder:[]},o=t[e++];let i;for(let n=0;n<o;n++){i=t[e];const n=t[e+1]>>4,o=15&t[e+1],s=t[e+2];r.componentsOrder.push(i),r.components[i]={h:n,v:o,quantizationIdx:s},e+=3}s(r),this.frames.push(r);break}case 65476:{const r=n();for(let n=2;n<r;){const r=t[e++],o=new Uint8Array(16);let s=0;for(let n=0;n<16;n++,e++)o[n]=t[e],s+=o[n];const c=new Uint8Array(s);for(let n=0;n<s;n++,e++)c[n]=t[e];n+=17+s,r>>4==0?this.huffmanTablesDC[15&r]=w(o,c):this.huffmanTablesAC[15&r]=w(o,c)}break}case 65501:n(),this.resetInterval=n();break;case 65498:{n();const r=t[e++],o=[],s=this.frames[0];for(let n=0;n<r;n++){const n=s.components[t[e++]],r=t[e++];n.huffmanTableDC=this.huffmanTablesDC[r>>4],n.huffmanTableAC=this.huffmanTablesAC[15&r],o.push(n)}const c=t[e++],i=t[e++],f=t[e++],a=d(t,e,s,o,this.resetInterval,c,i,f>>4,15&f);e+=a;break}case 65535:255!==t[e]&&e--;break;default:if(255===t[e-3]&&t[e-2]>=192&&t[e-2]<=254){e-=3;break}throw new Error(`unknown JPEG marker ${c.toString(16)}`)}c=n()}}getResult(){const{frames:t}=this;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(let t=0;t<this.frames.length;t++){const e=this.frames[t].components;for(const t of Object.keys(e))e[t].quantizationTable=this.quantizationTables[e[t].quantizationIdx],delete e[t].quantizationIdx}const e=t[0],{components:n,componentsOrder:r}=e,o=[],s=e.samplesPerLine,c=e.scanLines;for(let t=0;t<r.length;t++){const s=n[r[t]];o.push({lines:b(0,s),scaleX:s.h/e.maxH,scaleY:s.v/e.maxV})}const i=new Uint8Array(s*c*o.length);let f=0;for(let t=0;t<c;++t)for(let e=0;e<s;++e)for(let n=0;n<o.length;++n){const r=o[n];i[f]=r.lines[0|t*r.scaleY][0|e*r.scaleX],++f}return i}}class k extends r.Z{constructor(t){super(),this.reader=new m,t.JPEGTables&&this.reader.parse(t.JPEGTables)}decodeBlock(t){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(t)),this.reader.getResult().buffer}}}}]);
//# sourceMappingURL=382.ol.js.map