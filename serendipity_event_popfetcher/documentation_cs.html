<html>    
	<head>        
		<meta http-equiv="content-type" content="text/html; charset=windows-1250">
		<title>Dokumentace: POP3 stahovaè</title>        
		<style>
        	pre {
				display: block;
				padding: 5px;
				border: solid 1px #333333;
				background-color: #cccccc;
			}         
		</style>    
	</head>
	<body>
	<h1>Dokumentace k pluginu 'POP3 stahovaè'<br />
	<small>(serendipity_event_popfetcher)</small></h1>
		<p>Dokumentaci k tomuto pluginu pøeložil do èeštiny Vladimír Ajgl (vlada [zavinac] ajgl [tecka] cz) dne 14.4.2013. Od té doby mohl být plugin pozmìnìn nebo mohly být rozšíøené jeho funkce. Zkontrolujte pro jistotu i	<a href="docs.txt">aktuální anglickou dokumentaci</a> a <a href="ChangeLog">ChangeLog</a>. 
		</p>
		
    <h2>Autor</h2>
    Jason Levitt - <a href="mailto:fredb86@users.sourceforge.net">fredb86@users.sourceforge.net</a>

		<h2>Popis pluginu</h2>
    <p>Stáhuje zprávy z emailu a zobrazí je vèetnì pøíloh v bloku v postranním sloupci (obsahuje podporu pro mobilní telefony)</p>
    
    <h2>Obsah<h2>
    <ul>
    <li><a href="#nedostatky">Známé nedostatky</a></li>
    <li><a href="#pozadavky">Požadavky</a></li>
    <li><a href="#popis">Popis</a></li>
    <li><a href="#externi_interni">Externí proti internímu použití</a></li>
    <li><a href="#mobily">Podpora mobilních telefonù</a></li>    
    </ul>

    <a name="nedostatky"> </a>
    <h2>Známé nedostatky</h2>
    <ul>
    <li>
        <h3>emaily ve formátu HTML</h3>
        POP3 stahovaè oèekává emaily ve formátu èistého textu. HTML emaily mohou fungovat, ale jejich zobrazení bude nejspíš ménì než optimální.
    </li> 
    <li>
        <h3>POP3 pøes SSL</h3>
        Pokud se snažíte pøistupovat k POP3 pøes SSL šifrované spojení (na portu 995) a nemáte nainstalované PHP rozšíøení OpenSSL, uvidíte následující chybovou hlášku: <pre>ERROR: could not connect to mail server: POP3 connect: Error [0] [Unknown error: 0]</pre>  
    </li>
    </ul>

    <a name="pozadavky"> </a>
    <h2>Požadavky</h2>
    
    <ul>
      <li>Serendipity 0.8 nebo novìjší</li>
      <li>PHP 4.1 nebo novìjší, nebo PHP 5.x</li>
      <li>Emailový úèet pøístupný pomocí protokolu POP3</li>
    </ul>

    Váš emailový POP3 server musí podporovat UIDL (všechny moderní POP3 servery podporují UIDL). Pokud chcete pøistupovat k úètùm Gmail, nebo k dalším úètùm, které používají šifrování POP3 pøes SSL, musíte mít nainstalované PHP rozšíøení OpenSSL. K zapnutí POP3 pøes SSL jednoduše zmìòte v nastavení pluginu port ze 110 na 995.

    <a name="popis"> </a>
    <h2>Popis</h2>
    <p>
    Plugin pøidává do administraèního menu položku "POP3 stahovaè". Kliknutím na nìj stáhnete všechny emaily i s pøílohami z Vaší emailové schránky pomocí POP3 protokolu. Alternativnì mùže být tento plugin spouštìn samostatnì zvenku, typicky pluginem 'Plánovaè úloh' nebo Cronem.
    </p>
    <p>
     Pøílohy jsou dekódovány a pøesunuty do Knihovny médií. Navíc pokud je 'Pøíznak "Blog"' nastavený na 'Ano', každý email vèetnì pøíloh je zveøejnìn jako pøíspìvek blogu.
    </p>
    <p>
     SprintPCS (a na nižším stupni, tmobile, cingular a verizon) fotky, videa a audio pøílohy jsou rozpoznány a "vyèištìny" pøed publikováním.
    </p>


    <a name="externi_interni"> </a>
    <h2>Externí proti internímu použití</h2>
    <p>
    První nastavení v POP3 stahovaèi royhoduje, jestli POP3 stahovaè funguje jako "interní" nebo "externí" plugin.   
    </p>
    <p>
     Ve výchoyím stavu se POP3 stahovaè spouští jako "interní". To znamená, že vytváøí další položku menu v administraèním rozhraní a spustí se pouze pokud manuálnì kliknete na tuto položku menu "POP3 stahovaè". Takhle jednoduché to je.
    </p>
    <p>
    Alternativnì ho mùžete spouštìt jako "externí" plugin. To znamená, že je spouštìn z vnìjšku blogu pøístupem na speciální URL adresu. Abyste nejrùznìjším darebákùm zabránili ve spouštìní POP3 stahovaèe (nemìlo by to vliv na bezpeènost, ale bylo by to otravné:-) ), tak si zvolíte hestlo, které zadáte v nastavení POP3 stahovaèe, které musí být zadáno na konci spouštìcí URL adresy.
    </p>
    <p>
     URL adresa pro externí spouštìní vypadá nìjak takto:
     <pre>http://www.vasblog.cz/serendipity/index.php?/plugin/VASE_HESLO</pre>
     nebo pokud je zapnuté pøepisování adres (neboli Apache mod_rewrite), mùžete použít i následující formát:
     <pre>http://www.vasblog.cz/serendipity/plugin/VASE_HESLO</pre>
    </p>
    <p>
     Správnost nastavení byste mìli být schopni ruènì otestovat tak, že zadáte výše zmínìnou URL adresu do vašeho webového prohlížeèe.
    </p>
    <p>
     Pak mùžete pøidat položku do Cronu, který bude spouštìt POP3 stahovaè v pøednastavených intervalech. Testoval jsem to pomocí lynxu, ale mìlo by to fungovat i pomocí wget a curl. Tady je øádka do Cronu, kterou používám:
     <pre>*/30 * * * * /usr/local/bin/lynx -dump http://www.mujblog.cz/serendipity/index.php?/plugin/MOJE_HESLO 
>> /htdocs/serendipity/uploads/0000log.txt 2>&1</pre>
     
     samozøejmì, pokud máte zapnuté pøepisování adres (neboli Apache mod_rewrite), mùžete použít následující formát:
     <pre>*/30 * * * * /usr/local/bin/lynx -dump http://www.mujblog.cz/serendipity/plugin/MOJE_HESLO 
>> /htdocs/serendipity/uploads/0000log.txt 2>&1</pre>
     
     tady je verze pomocí wgetu:
     <pre>*/30 * * * * /usr/local/bin/wget -O - -q http://www.mujblog.cz/serendipity/plugin/MOJE_HESLO 
>> /htdocs/serendipity/uploads/0000log.txt 2>&1</pre>
     
     a verze pomocí GETu:
     <pre>*/30 * * * * /usr/local/bin/GET http://www.mujblog.cz/serendipity/index.php?/plugin/MOJE_HESLO 
>> /htdocs/serendipity/uploads/0000log.txt 2>&1</pre>
    </p>
    <p>
    Tato Cronová úloha spustí POP3 stahovaè každých 30 minut. Všechny logovací výstupy jsou zapsány do souboru "0000log.txt". Zvolil jsem toto jméno tak, aby skonèilo v Knihovnì médií až úplnì na konci. Pokud zvolíte filtrování pomocí "názvu souboru" a "sestupnì", skoro magicky se zobrazí jako první položka v Knihovnì médií. Mohli byste si ho také pojmenovat "aaaalog.txt" a pak by se vždy zobrazoval na zaèátku. Mùžete použít Knihovnu médií k pøeètení tohoto logovacího souboru pokaždé, když máte podezøení, že POP3 stahovaè nefunguje správnì.  
    </p>

    <a name="mobily"> </a>
    <h2>Podpora mobilních telefonù</h2>
    <p>
    POP3 stahovaè automaticky rozpozná nìkteré pøílohy z mobilních telefonù (aktuálnì pouze u operátorù v USA) a pøesune všechny fotky, videa a zvukové soubory do vaší Knihovny médií. Podpora této funkce ja daleko od ideálu, ale funguje docela dobøe pro Sprint a celkem ujde pro nìkteré telefony u ostatních operátorù.
    </p>
		
		<h2>Historie verzí (ChangeLog)</h2>
		<ul>
			<li>verze 1.42</li>	
			<ul>	
				<li>Pøidání syntxe [attach:X] k textovým pøílohám, kde X oznaèuje èíslo pøílohy (zaèíná od èísla 1), u pøíloh, které mají být vloženy inline</li>	
			</ul>
			<li>verze 1.41</li>	
			<ul>	
				<li>Nyní umí parsovat vložené HTML obrázky a nahradit je soubory z pøíloh</li>	
			</ul>
			<li>verze 1.37 [danst0]</li>	
			<ul>	
				<li>Zmìna funkce 'ereg' na 'preg_hatcm'</li>	
				<li>Pøidáno návìští k indikaci, jestli je zobrazen náhled nebo celý obrázek.</li>	
			</ul>
			<li>verze 1.36</li>	
			<ul>	
				<li>Umožnìní nastavení podadresáøe Maildir pro uložení emailù a ladìní funkce pluginu.</li>	
				<li>Zvyšování poèítadla duplicit v pøílohách, aby se zabránilo problémùm v pøípadì, že je ve stejné sekundì pøijat víc než jeden email s pøílohami.</li>	
			</ul>
			<li>verze 1.35</li>	
			<ul>	
				<li>Detekce format=flowed</li>	
				<li>Opravena chyba, která nevyèistila správnì "rozšíøenou textovou èást" pro následující email, což vedlo k tomu, že se míchaly texty rùzných emailù.</li>	
			</ul>
			<li>verze 1.34</li>	
			<ul>	
				<li>Pøidána schopnost rozpoznat emaily poslané jako odpovìï (Re:/Aw:/Wg:) a publikovat je jako komentáøe spíše než jako pøíspìvky.</li>	
				<li>Pøidána schopnost rozpoznat datum importovaného emailu</li>	
				<li>Pøidána možnost pro zapnutí návìští $debug pro logování zpráv z výstupu Cronu</li>	
				<li>Rozpoznání nìkterých základních textových znaèek (->, >>, => apod.), aby byly escapovány.</li>	
				<li>Odstranìní všech CR/LF znakù ufnitø tagù &lt;embed&gt; a &lt;object&gt; a uvnitø všech HTML tagù.</li>	
				<li>Nahrazení HTML uvnitø komentáøových mailù znaèkami BBCode.</li>	
				<li>Detekce znakové sady us-ascii jako ISO-8859-1</li>	
				<li>Ukládání nahraných souborù v adresáøové struktuøe ROK/MÌSÍC.</li>	
				<li>Zacházet s obrázky vloženými do textu tak, že budou vloženy do rozšíøené textové èásti po prvním.</li>	
			</ul>
			<li>verze 1.33</li>	
			<ul>	
				<li>Vylepšeno dekódování øetìzcù, aby nefungovalo pouze UTF-8 <-> ISO. Díky uživateli [B. Tittelbach] (<a href="https://sourceforge.net/tracker/?func=detail&atid=542822&aid=2831116&group_id=75065">https://sourceforge.net/tracker/?func=detail&atid=542822&aid=2831116&group_id=75065</a>)</li>	
			</ul>
		</ul>  

	</body>
</html>
